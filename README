TO-DO: 

Integrate the serial check for cuda.
Scaling and timings in cuda. 